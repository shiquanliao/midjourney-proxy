"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[903],{43705:function(Lr,we,o){o.r(we),o.d(we,{default:function(){return Za}});var ca=o(97857),T=o.n(ca),pa=o(15009),I=o.n(pa),ga=o(64599),q=o.n(ga),fa=o(19632),ma=o.n(fa),va=o(99289),H=o.n(va),ha=o(5574),m=o.n(ha),x=o(66927),ba=o(18429),Sa=o(51042),Te=o(52645),ja=o(90930),Ca=o(94272),W=o(26915),te=o(4393),ya=o(16568),S=o(2453),P=o(28036),wa=o(7134),U=o(86250),_=o(42075),Ta=o(66309),Ia=o(11499),Ie=o(74330),xa=o(38703),L=o(66476),xe=o(78045),Pe=o(74656),Pa=o(28248),f=o(67294),Ae=o(87419),de={cardTitleTime:"cardTitleTime___ULudn",taskErrorTip:"taskErrorTip___EJ9yV","videos-container":"videos-container___OhNQp","video-item":"video-item___z87Fy","video-wrapper":"video-wrapper___ZpmfN","video-player":"video-player___sVGXY","video-overlay":"video-overlay___CdOP6","video-actions":"video-actions___mWn0D","button-group":"button-group___gweCL","group-label":"group-label___mIcIE","group-buttons":"group-buttons___mGTvE","ant-btn":"ant-btn___O07ju","action-btn":"action-btn___d6WZz",secondary:"secondary___XbL5f","btn-emoji":"btn-emoji___tSdOt","btn-label":"btn-label___e_LaX","task-header":"task-header___hSKmm","task-info":"task-info___sGARu","task-meta":"task-meta___kz8_A"},a=o(85893),ne=W.Z.TextArea,Aa=te.Z.Meta,Ea=function(){var Ma=ya.ZP.useNotification(),Ee=m()(Ma,2),O=Ee[0],Fa=Ee[1],Ra=(0,f.useState)([]),Ze=m()(Ra,2),ka=Ze[0],Me=Ze[1],Na=(0,f.useState)(!1),Fe=m()(Na,2),Ua=Fe[0],Re=Fe[1],Oa=(0,f.useState)("imagine"),ke=m()(Oa,2),C=ke[0],Da=ke[1],Ba=(0,f.useState)("MID_JOURNEY"),Ne=m()(Ba,2),w=Ne[0],La=Ne[1],Ja=(0,f.useState)(""),Ue=m()(Ja,2),Z=Ue[0],V=Ue[1],Wa=(0,f.useState)("SQUARE"),Oe=m()(Wa,2),De=Oe[0],Va=Oe[1],za=(0,f.useState)([]),Be=m()(za,2),D=Be[0],z=Be[1],Ga=(0,f.useState)([]),Le=m()(Ga,2),R=Le[0],ee=Le[1],Ha=(0,f.useState)([]),Je=m()(Ha,2),k=Je[0],ae=Je[1],Ya=(0,f.useState)(""),We=m()(Ya,2),ce=We[0],Ve=We[1],$a=(0,f.useState)(!1),ze=m()($a,2),J=ze[0],A=ze[1],Xa=(0,f.useState)(new Set),Qa=m()(Xa,1),y=Qa[0],Ka=(0,f.useState)(!1),Ge=m()(Ka,2),qa=Ge[0],Y=Ge[1],_a=(0,f.useState)(""),He=m()(_a,2),er=He[0],ar=He[1],rr=(0,f.useState)(""),Ye=m()(rr,2),ie=Ye[0],$e=Ye[1],sr=(0,f.useState)(""),Xe=m()(sr,2),pe=Xe[0],tr=Xe[1],nr=(0,f.useState)(""),Qe=m()(nr,2),le=Qe[0],Ke=Qe[1],ir=(0,f.useState)(0),qe=m()(ir,2),_e=qe[0],lr=qe[1],or=(0,f.useState)(!1),ea=m()(or,2),ur=ea[0],dr=ea[1],cr=(0,f.useState)(!1),aa=m()(cr,2),pr=aa[0],ra=aa[1],gr=(0,f.useState)([]),sa=m()(gr,2),fr=sa[0],mr=sa[1],vr=(0,f.useState)(),ta=m()(vr,2),$=ta[0],hr=ta[1],u=(0,Ca.useIntl)(),ge=(0,f.useRef)([]),X=(0,f.useRef)(null),B="midjourney-proxy-admin",fe=sessionStorage.getItem("mj-image-prefix")||"";(0,f.useEffect)(function(){return jr({state:B,pageNumber:0,pageSize:3,statusSet:["NOT_START","SUBMITTED","IN_PROGRESS","FAILURE","SUCCESS"],sort:"submitTime,desc"}),X.current&&clearInterval(X.current),X.current=setInterval(function(){y.size!==0&&br()},2e3),function(){X.current&&(clearInterval(X.current),X.current=null)}},[]);var br=function(){var i=H()(I()().mark(function e(){var r,l,n,g,t,d,c,F,v,h,j;return I()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return r=Array.from(y),l=new Set(r),b.next=4,(0,x.BX)(r);case 4:n=b.sent,g=!1,t=ma()(ge.current),d=q()(n),b.prev=8,F=I()().mark(function K(){var N,s;return I()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:N=c.value,l.delete(N.id),(N.status==="FAILURE"||N.status==="SUCCESS"||N.status==="CANCEL")&&y.delete(N.id),s=t.find(function(Br){return Br.id===N.id}),s?Sr(s,N)||(g=!0,t.splice(t.indexOf(s),1,N)):(g=!0,t.push(N));case 5:case"end":return E.stop()}},K)}),d.s();case 11:if((c=d.n()).done){b.next=15;break}return b.delegateYield(F(),"t0",13);case 13:b.next=11;break;case 15:b.next=20;break;case 17:b.prev=17,b.t1=b.catch(8),d.e(b.t1);case 20:return b.prev=20,d.f(),b.finish(20);case 23:v=q()(l);try{for(v.s();!(h=v.n()).done;)j=h.value,y.delete(j)}catch(K){v.e(K)}finally{v.f()}g&&(ge.current=t,Me(t),na());case 26:case"end":return b.stop()}},e,null,[[8,17,20,23]])}));return function(){return i.apply(this,arguments)}}(),Sr=function(e,r){return e.status===r.status&&e.progress===r.progress&&e.imageUrl===r.imageUrl},na=function(){setTimeout(function(){var e=document.getElementById("task-panel");e&&e.scrollTo(0,e.scrollHeight)},20)},jr=function(){var i=H()(I()().mark(function e(r){var l,n,g,t,d,c;return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return Re(!0),v.next=3,(0,x.Ed)();case 3:return l=v.sent,mr(l),v.next=7,(0,x.Pn)(r);case 7:n=v.sent,g=n.list.reverse(),t=q()(g);try{for(t.s();!(d=t.n()).done;)c=d.value,c.status!=="FAILURE"&&c.status!=="SUCCESS"&&c.action!=="CANCEL"&&y.add(c.id)}catch(h){t.e(h)}finally{t.f()}ge.current=g,Me(g),Re(!1),na();case 15:case"end":return v.stop()}},e)}));return function(r){return i.apply(this,arguments)}}(),Cr=function(e){Da(e),V(""),z([])},yr=function(e){hr(e)},wr=function(e){var r=e.target.value;La(r),V(""),z([])},Tr=function(e){var r=e.target.value;Va(r)},oe=function(e){V(e.target.value)},ia=function(e){$e(e.target.value)},Q=function(){var i=H()(I()().mark(function e(r){return I()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(g){var t=new FileReader;t.onload=function(){return g(t.result)},t.readAsDataURL(r)});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},e)}));return function(r){return i.apply(this,arguments)}}(),M=function(){var i=H()(I()().mark(function e(){var r,l,n,g,t,d,c,F,v,h,j,se,b,K;return I()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(w==="INSIGHT_FACE"||w==="FACE_SWAP")){s.next=26;break}if(!(R.length<1)){s.next=4;break}return S.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 4:if(!(k.length<1)){s.next=7;break}return S.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 7:if(A(!0),r={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:B},!R[0].originFileObj){s.next=15;break}return s.next=12,Q(R[0].originFileObj);case 12:r.sourceBase64=s.sent,s.next=16;break;case 15:r.sourceUrl=R[0].name;case 16:if(!k[0].originFileObj){s.next=22;break}return s.next=19,Q(k[0].originFileObj);case 19:r.targetBase64=s.sent,s.next=23;break;case 22:r.targetUrl=k[0].name;case 23:(0,x.Vl)(r).then(function(p){A(!1),p.code===22||p.code===1?(p.code===22?O.warning({message:"warn",description:p.description}):S.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),y.add(p.result),ee([]),ae([])):O.error({message:"error",description:p.description})}),s.next=143;break;case 26:if(w!=="VIDEO_FACE_SWAP"){s.next=51;break}if(!(R.length<1)){s.next=30;break}return S.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 30:if(!(k.length<1)){s.next=33;break}return S.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 33:if(A(!0),l={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:B},!R[0].originFileObj){s.next=41;break}return s.next=38,Q(R[0].originFileObj);case 38:l.sourceBase64=s.sent,s.next=42;break;case 41:l.sourceUrl=R[0].name;case 42:n=new FormData,k[0].originFileObj?n.append("TargetFile",k[0].originFileObj):l.targetUrl=k[0].name,n.append("SourceBase64",l.sourceBase64||""),n.append("SourceUrl",l.sourceUrl||""),n.append("TargetUrl",l.targetUrl||""),n.append("Satate",l.state),(0,x.Wv)(n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(p){A(!1),p.code===22||p.code===1?(p.code===22?O.warning({message:"warn",description:p.description}):S.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),y.add(p.result),ee([]),ae([])):O.error({message:"error",description:p.description})}),s.next=143;break;case 51:if(C!=="show"){s.next=59;break}if(Z){s.next=55;break}return S.ZP.error(u.formatMessage({id:"pages.draw.taskIdNotBlank"})),s.abrupt("return");case 55:y.add(Z),V(""),s.next=143;break;case 59:if(C!=="showjobid"){s.next=67;break}if(Z){s.next=63;break}return S.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 63:A(!0),(0,x.cq)("show",{botType:w,jobId:Z,state:B,accountFilter:{instanceId:$}}).then(function(p){A(!1);var E=re(p);E&&(y.add(p.result),V(""),z([]))}),s.next=143;break;case 67:if(C!=="imagine"){s.next=95;break}if(Z){s.next=71;break}return S.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 71:A(!0),g=[],t=q()(D),s.prev=74,t.s();case 76:if((d=t.n()).done){s.next=84;break}return c=d.value,s.next=80,Q(c.originFileObj);case 80:F=s.sent,g.push(F);case 82:s.next=76;break;case 84:s.next=89;break;case 86:s.prev=86,s.t0=s.catch(74),t.e(s.t0);case 89:return s.prev=89,t.f(),s.finish(89);case 92:(0,x.qJ)(C,{botType:w,prompt:Z,base64Array:g,state:B,accountFilter:{instanceId:$}}).then(function(p){A(!1);var E=re(p);E&&(y.add(p.result),V(""),z([]))}),s.next=143;break;case 95:if(C!=="blend"){s.next=123;break}if(!(D.length<2)){s.next=99;break}return S.ZP.error(u.formatMessage({id:"pages.draw.blendTip"})),s.abrupt("return");case 99:A(!0),v=[],h=q()(D),s.prev=102,h.s();case 104:if((j=h.n()).done){s.next=112;break}return se=j.value,s.next=108,Q(se.originFileObj);case 108:b=s.sent,v.push(b);case 110:s.next=104;break;case 112:s.next=117;break;case 114:s.prev=114,s.t1=s.catch(102),h.e(s.t1);case 117:return s.prev=117,h.f(),s.finish(117);case 120:(0,x.qJ)(C,{botType:w,base64Array:v,dimensions:De,state:B,accountFilter:{instanceId:$}}).then(function(p){A(!1);var E=re(p);E&&(y.add(p.result),z([]))}),s.next=143;break;case 123:if(C!=="describe"){s.next=134;break}if(!(D.length<1)){s.next=127;break}return S.ZP.error(u.formatMessage({id:"pages.draw.imageEmptyTip"})),s.abrupt("return");case 127:return A(!0),s.next=130,Q(D[0].originFileObj);case 130:K=s.sent,(0,x.qJ)(C,{botType:w,base64:K,state:B,accountFilter:{instanceId:$}}).then(function(p){A(!1);var E=re(p);E&&(y.add(p.result),z([]))}),s.next=143;break;case 134:if(C!=="shorten"){s.next=142;break}if(Z){s.next=138;break}return S.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 138:A(!0),(0,x.qJ)(C,{botType:w,prompt:Z,state:B,accountFilter:{instanceId:$}}).then(function(p){A(!1);var E=re(p);E&&(y.add(p.result),V(""))}),s.next=143;break;case 142:S.ZP.error(u.formatMessage({id:"pages.draw.unsupportedAction"}));case 143:case"end":return s.stop()}},e,null,[[74,86,89,92],[102,114,117,120]])}));return function(){return i.apply(this,arguments)}}(),re=function(e){return e.code===22||e.code===1?(e.code===22?O.warning({message:"warn",description:e.description}):S.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),!0):(O.error({message:"error",description:e.description}),!1)},me=function(e,r){var l=r.customId,n=e.id,g="".concat(r.emoji," ").concat(r.label);Ve("".concat(n,":").concat(l)),(0,x.qJ)("action",{taskId:n,customId:l,state:B,chooseSameChannel:!0}).then(function(t){if(Ve(""),t.code===22)O.warning({message:"warn",description:t.description}),r.style=3,y.add(t.result);else if(t.code===21){if(r.style=3,ar("".concat(t.result," ").concat(g)),tr(t.result),$e(t.properties.finalPrompt),dr(t.properties.remix||!1),l.startsWith("MJ::Inpaint:")){var d="".concat(fe).concat(e.imageUrl),c=new Image;c.src=d,c.onload=function(){lr(Math.floor(550/c.width*c.height)),Ke(d),Y(!0),setTimeout(function(){Ir()},300)}}else Ke(""),Y(!0);Y(!0)}else if(t.code===1){if(r.style=3,t.result){var F=t.result.split(",");F.forEach(function(v){y.add(v)})}S.ZP.success(u.formatMessage({id:"pages.draw.actionSuccess"}))}else O.error({message:"error",description:t.description})})},ve=!1,he=0,be=0,Ir=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getBoundingClientRect(),l=Math.floor(r.left),n=Math.floor(r.top),g=e.getContext("2d");g.fillStyle="blue",e.onmousedown=function(t){he=t.clientX,be=t.clientY,ve=!0},e.onmousemove=function(t){ve===!0&&g.fillRect(he-l,be-n,t.clientX-he,t.clientY-be)},e.onmouseup=function(){ve=!1}},xr=function(){(0,x.el)(pe),Y(!1)},Pr=function(){var i=H()(I()().mark(function e(){var r,l,n,g;return I()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(ra(!0),!le){d.next=11;break}return l=document.getElementById("canvas"),n=new Image,n.src=l.toDataURL("image/png"),d.next=7,Ar(n);case 7:g=d.sent,r={maskBase64:g,taskId:pe,prompt:ie},d.next=12;break;case 11:r={taskId:pe,prompt:ie};case 12:(0,x.qJ)("modal",r).then(function(c){ra(!1),c.code===22?(O.warning({message:"warn",description:c.description}),y.add(c.result),Y(!1)):c.code===1?(y.add(c.result),Y(!1),S.ZP.success(u.formatMessage({id:"pages.draw.subSuccess"}))):O.error({message:"error",description:c.description})});case 13:case"end":return d.stop()}},e)}));return function(){return i.apply(this,arguments)}}(),Ar=function(){var i=H()(I()().mark(function e(r){return I()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(g){r.onload=function(){var t=r.width,d=r.height,c=document.createElement("canvas"),F=c.getContext("2d");c.width=t,c.height=d,F.drawImage(r,0,0,t,d);for(var v=F.getImageData(0,0,t,d),h=v.data,j=0;j<h.length;j+=4)h[j]!==0||h[j+1]!==0||h[j+2]!==0?(h[j]=parseInt("0xff"),h[j+1]=parseInt("0xff"),h[j+2]=parseInt("0xff")):(h[j]=0,h[j+1]=0,h[j+2]=0,h[j+3]=255);F.putImageData(v,0,0);var se=c.toDataURL("png");g(se)}});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},e)}));return function(r){return i.apply(this,arguments)}}(),Er=function(e){var r="Midjourney - ".concat(e.displays.discordInstanceId);return e.botType==="NIJI_JOURNEY"?r="niji\u30FBjourney - ".concat(e.displays.discordInstanceId):(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP")&&(r="InsightFaceSwap - ".concat(e.displays.discordInstanceId)),e.status!=="SUCCESS"&&e.status!=="FAILURE"&&e.status!=="CANCEL"&&e.action!=="SWAP_FACE"?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime}),(0,a.jsx)(P.ZP,{style:{marginLeft:"10px"},type:"link",shape:"circle",icon:(0,a.jsx)(ba.Z,{}),onClick:function(){return(0,x.el)(e.id)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime})]})},Zr=function(e){var r=e.description,l=e.properties.messageContent;return l&&(r=l.replace(/<@[^>]+>/g,"")),(0,a.jsx)(Ae.U,{children:r})},Mr=function(){return ka.map(function(e){var r="./midjourney.webp";return e.botType==="NIJI_JOURNEY"?r="./niji.webp":(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP"||e.botType==="VIDEO_FACE_SWAP")&&(r="./insightface.webp"),(0,a.jsxs)(te.Z,{bordered:!1,bodyStyle:{backgroundColor:"#eaeaea",marginBottom:"10px"},children:[(0,a.jsx)(Aa,{avatar:(0,a.jsx)(wa.C,{src:r}),title:Er(e),description:Zr(e)}),(0,a.jsxs)(U.Z,{vertical:!0,style:{paddingLeft:"48px"},children:[Nr(e),(0,a.jsx)(_.Z,{wrap:!0,style:{marginTop:"7px"},children:kr(e)})]})]},e.id)})},Se=function(e){if(!e.properties.finalPrompt)return(0,a.jsx)(a.Fragment,{});var r=e.properties.finalPrompt;return(0,a.jsx)(Ae.U,{children:r.replace(new RegExp("(?<!\\n)\\n","g"),`

`)})},ue=function(e){if(e.status==="FAILURE")return(0,a.jsx)("span",{className:de.taskErrorTip,children:e.failReason});if(e.status==="SUCCESS")return(0,a.jsx)(a.Fragment,{});if(e.status==="IN_PROGRESS")return(0,a.jsx)(a.Fragment,{children:Rr(e)});var r="purple";return e.status==="SUBMITTED"?r="lime":e.status==="CANCEL"?r="magenta":e.status==="MODAL"&&(r="warning"),(0,a.jsx)("span",{children:(0,a.jsx)(Ta.Z,{color:r,children:e.displays.status})})},la=function(e,r){return e?(0,a.jsx)(Ia.Z,{width:r,src:"".concat(fe).concat(e),placeholder:(0,a.jsx)(Ie.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Fr=function(e,r){return e?(0,a.jsx)("video",{width:r,controls:!0,src:fe+e,placeholder:(0,a.jsx)(Ie.Z,{tip:"Loading",size:"large"})}):(0,a.jsx)(a.Fragment,{})},Rr=function(e){var r=e.progress,l=0;return r&&r.indexOf("%")>0&&(l=parseInt(r.substring(0,r.indexOf("%")))),(0,a.jsx)("span",{style:{width:250},children:(0,a.jsx)(xa.Z,{percent:l,status:"normal"})})},kr=function(e){return e.buttons.map(function(r){return(0,a.jsxs)(P.ZP,{ghost:!0,style:{backgroundColor:r.style===3?"#258146":"rgb(131 133 142)"},onClick:function(){me(e,r)},loading:ce==="".concat(e.id,":").concat(r.customId),children:[r.emoji," ",r.label]},"".concat(e.id,":").concat(r.customId))})},G=(0,a.jsxs)("div",{children:[(0,a.jsx)(Sa.Z,{}),(0,a.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),Nr=function(e){return e.action==="DESCRIBE"?(0,a.jsxs)(a.Fragment,{children:[ue(e)," ",Se(e)," ",la(e.imageUrl,120)]}):e.action==="SHORTEN"?(0,a.jsxs)(a.Fragment,{children:[ue(e)," ",Se(e)]}):e.action==="VIDEO"||e.action==="VIDEO_EXTEND"?(0,a.jsxs)("div",{className:"video-task-card",children:[ue(e)," ",Se(e),e.videoUrls&&e.videoUrls.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"task-header",children:(0,a.jsxs)("div",{className:"task-meta",children:[(0,a.jsxs)("span",{className:"task-duration",children:[e.videoDuration,"s"]}),(0,a.jsxs)("span",{className:"task-frames",children:[e.frameCount," frames"]})]})}),(0,a.jsx)("div",{className:"videos-container",children:e.videoUrls.map(function(r,l){return(0,a.jsxs)("div",{className:"video-item",children:[(0,a.jsxs)("div",{className:"video-wrapper",children:[(0,a.jsxs)("video",{controls:!0,loop:!0,muted:!0,className:"video-player",poster:e.videoGenOriginImageUrl,children:[(0,a.jsx)("source",{src:r.url,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E\u3002"]}),(0,a.jsx)("div",{className:"video-overlay",children:(0,a.jsxs)("span",{className:"video-index",children:["#",l+1]})})]}),(0,a.jsx)("div",{className:"video-actions",children:function(){var n=r.buttons.filter(function(t){return t.customId.includes("::manual")}),g=r.buttons.filter(function(t){return t.customId.includes("::auto")});return(0,a.jsxs)(a.Fragment,{children:[g.length>0&&(0,a.jsxs)("div",{className:"button-group",children:[(0,a.jsx)("div",{className:"group-label",children:"Auto Extend"}),(0,a.jsx)("div",{className:"group-buttons",children:g.map(function(t,d){return(0,a.jsx)(P.ZP,{ghost:!0,size:"small",style:{backgroundColor:t.style===3?"#258146":"rgb(131 133 142)",fontSize:"11px",height:"28px",padding:"0 8px"},onClick:function(){me(e,t)},loading:ce==="".concat(e.id,":").concat(t.customId),children:t.label.replace("Extend ","").replace("Auto ","")},d)})})]}),n.length>0&&(0,a.jsxs)("div",{className:"button-group",children:[(0,a.jsx)("div",{className:"group-label",children:"Manual Extend"}),(0,a.jsx)("div",{className:"group-buttons",children:n.map(function(t,d){return(0,a.jsx)(P.ZP,{ghost:!0,size:"small",style:{backgroundColor:t.style===3?"#258146":"rgb(131 133 142)",fontSize:"11px",height:"28px",padding:"0 8px"},onClick:function(){me(e,t)},loading:ce==="".concat(e.id,":").concat(t.customId),children:t.label.replace("Extend ","").replace("Manual ","")},d)})})]})]})}()})]},l)})})]})]}):(0,a.jsxs)(a.Fragment,{children:[ue(e),e.action==="SWAP_VIDEO_FACE"?(0,a.jsx)(a.Fragment,{children:Fr(e.imageUrl,250)}):la(e.imageUrl,250)]})},Ur=function(){return w==="INSIGHT_FACE"||w==="FACE_SWAP"?(0,a.jsxs)(U.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(L.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(L.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2Desc"})}),(0,a.jsx)(P.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapDesc"})})]}):w==="VIDEO_FACE_SWAP"?(0,a.jsxs)(U.Z,{vertical:!0,gap:8,children:[(0,a.jsx)(L.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ee([{uid:"1",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,a.jsx)(L.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:G})),(0,a.jsx)(W.Z,{onChange:function(r){r.target.value&&ae([{uid:"2",name:r.target.value,url:r.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2VidelDesc"})}),(0,a.jsx)(P.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapVideoDesc"})})]}):C==="show"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputIdShow"}),value:Z,onChange:oe,onPressEnter:M}),(0,a.jsx)(P.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="showjobid"?(0,a.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,a.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputJobIdShow"}),value:Z,onChange:oe,onPressEnter:M}),(0,a.jsx)(P.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="imagine"?(0,a.jsxs)(U.Z,{vertical:!0,children:[(0,a.jsx)(L.Z,T()(T()({},ye),{},{listType:"picture-card",children:D.length>=5?null:G})),(0,a.jsxs)(U.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:Z,onChange:oe,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(P.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="blend"?(0,a.jsxs)(U.Z,{vertical:!0,children:[(0,a.jsx)(L.Z,T()(T()({},ye),{},{listType:"picture-card",children:D.length>=5?null:G})),(0,a.jsxs)(_.Z,{style:{width:"100%",marginTop:"10px"},children:[(0,a.jsx)(xe.ZP.Group,{value:De,onChange:Tr,options:[{value:"PORTRAIT",label:u.formatMessage({id:"pages.draw.PORTRAIT"})},{value:"SQUARE",label:u.formatMessage({id:"pages.draw.SQUARE"})},{value:"LANDSCAPE",label:u.formatMessage({id:"pages.draw.LANDSCAPE"})}],optionType:"button"}),(0,a.jsx)(P.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):C==="describe"?(0,a.jsxs)(U.Z,{vertical:!0,children:[(0,a.jsx)(L.Z,T()(T()({},ye),{},{listType:"picture-card",children:D.length>=1?null:G})),(0,a.jsx)(P.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):C==="shorten"?(0,a.jsxs)(U.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,a.jsx)(ne,{placeholder:"Prompt",value:Z,onChange:oe,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,a.jsx)(P.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):(0,a.jsx)(a.Fragment,{})},oa=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var r=e.getContext("2d");r.fillStyle="blue"},Or=function(){return le?ur?(0,a.jsxs)(U.Z,{vertical:!0,children:[(0,a.jsx)(P.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(Te.Z,{}),onClick:oa,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(le,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:_e}),(0,a.jsx)(ne,{style:{marginTop:"10px"},rows:2,value:ie,onChange:ia})]}):(0,a.jsxs)(U.Z,{vertical:!0,children:[(0,a.jsx)(P.ZP,{style:{marginBottom:"10px"},icon:(0,a.jsx)(Te.Z,{}),onClick:oa,children:u.formatMessage({id:"pages.draw.clear"})}),(0,a.jsx)("canvas",{style:{backgroundImage:"url('".concat(le,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:_e})]}):(0,a.jsx)(ne,{rows:3,value:ie,onChange:ia})};function je(i){i.onSuccess()}var Ce=function(e){var r=e.type==="image/jpeg"||e.type==="image/png"||e.type==="video/mp4"||e.type==="image/webp";r||S.ZP.error(u.formatMessage({id:"pages.draw.onlyJpgPng"}));var l=e.size/1024/1024<10;return l||S.ZP.error(u.formatMessage({id:"pages.draw.limit10M"})),r&&l||L.Z.LIST_IGNORE},ye={customRequest:je,beforeUpload:Ce,fileList:D,onChange:function(e){z(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},ua={customRequest:je,beforeUpload:Ce,maxCount:1,fileList:R,onChange:function(e){ee(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},da={customRequest:je,beforeUpload:Ce,maxCount:1,fileList:k,onChange:function(e){ae(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},Dr=function(){var e,r=!1;w==="INSIGHT_FACE"||w==="FACE_SWAP"||w==="VIDEO_FACE_SWAP"?(r=!0,e=[{value:"swap",label:"/swap"}]):e=[{value:"imagine",label:"/imagine"},{value:"blend",label:"/blend"},{value:"describe",label:"/describe"},{value:"shorten",label:"/shorten"},{value:"showjobid",label:"/show job_id"},{value:"show",label:"/show task_id"}];var l=fr.map(function(n){return{value:n.channelId,label:n.channelId+" - "+(n.remark||""),disabled:!n.enable||!n.running}});return(0,a.jsxs)(_.Z,{style:{marginBottom:"10px"},children:[(0,a.jsx)(Pe.Z,{value:r?"swap":C,style:{width:150},onChange:Cr,options:e}),(0,a.jsx)(Pe.Z,{value:$,style:{width:320},onChange:yr,options:l,allowClear:!0,placeholder:u.formatMessage({id:"pages.draw.selectAccount"})}),(0,a.jsx)(xe.ZP.Group,{value:w,onChange:wr,options:[{value:"MID_JOURNEY",label:"Midjourney"},{value:"NIJI_JOURNEY",label:"niji\u30FBjourney"},{value:"FACE_SWAP",label:"FaceSwap"},{value:"VIDEO_FACE_SWAP",label:"Video\u30FBFaceSwap"}],optionType:"button"})]})};return(0,a.jsxs)(ja._z,{children:[Fa,(0,a.jsx)(te.Z,{style:{marginBottom:"15px",overflow:"auto",height:"70vh"},loading:Ua,id:"task-panel",children:Mr()}),(0,a.jsxs)(te.Z,{children:[Dr(),Ur()]}),(0,a.jsx)(Pa.Z,{title:er,open:qa,onCancel:xr,onOk:Pr,confirmLoading:pr,width:600,children:Or()})]})},Za=Ea}}]);
