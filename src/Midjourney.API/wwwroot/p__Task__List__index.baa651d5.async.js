"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[502],{12154:function(ae,y,i){i.r(y),i.d(y,{default:function(){return fe}});var F=i(97857),A=i.n(F),N=i(15009),p=i.n(N),x=i(99289),j=i.n(x),L=i(5574),v=i.n(L),P=i(27986),R=i(94272),I=i(66309),X=i(38703),te=i(83062),U=i(11499),S=i(74330),n=i(26412),se=i(86250),V=i(4393),e=i(85893),re=function(w){var a=w.record,l=(0,R.useIntl)(),Z=sessionStorage.getItem("mj-image-prefix")||"",B=function(s){var g="default";return s=="NOT_START"?g="default":s=="SUBMITTED"?g="lime":s=="MODAL"?g="warning":s=="IN_PROGRESS"?g="processing":s=="FAILURE"?g="error":s=="SUCCESS"?g="success":s=="CANCEL"&&(g="magenta"),(0,e.jsx)(I.Z,{color:g,children:a.displays.status})},k=function(s){var g=0;s&&s.indexOf("%")>0&&(g=parseInt(s.substring(0,s.indexOf("%"))));var T="normal";return a.status=="SUCCESS"?T="success":a.status=="FAILURE"&&(T="exception"),(0,e.jsx)("div",{style:{width:200},children:(0,e.jsx)(X.Z,{percent:g,status:T})})},f=function(s){return!s||s.length<30?s:(0,e.jsx)(te.Z,{title:s,children:s.substring(0,30)+"..."})},C=function(s){return s&&(0,e.jsx)(U.Z,{width:200,src:Z+s,placeholder:(0,e.jsx)(S.Z,{tip:"Loading",size:"large"})})},W=function(s){return s&&(0,e.jsx)("video",{width:"200",controls:!0,src:Z+s,placeholder:(0,e.jsx)(S.Z,{tip:"Loading",size:"large"})})},O=function(){return!a.videoUrls||a.videoUrls.length===0?null:(0,e.jsxs)("div",{className:"video-task-detail",children:[(0,e.jsxs)("div",{className:"video-info",style:{marginBottom:"16px"},children:[(0,e.jsxs)(I.Z,{color:"blue",children:["\u65F6\u957F: ",a.videoDuration,"s"]}),(0,e.jsxs)(I.Z,{color:"green",children:["\u5E27\u6570: ",a.frameCount]})]}),(0,e.jsx)("div",{className:"videos-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:a.videoUrls.map(function(s,g){return(0,e.jsx)("div",{className:"video-detail-item",children:(0,e.jsxs)("div",{style:{position:"relative",marginBottom:"8px"},children:[(0,e.jsxs)("video",{controls:!0,loop:!0,muted:!0,style:{width:"200px",height:"200px",objectFit:"cover",borderRadius:"8px"},poster:a.videoGenOriginImageUrl,children:[(0,e.jsx)("source",{src:s.url,type:"video/mp4"}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u89C6\u9891\u64AD\u653E\u3002"]}),(0,e.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["#",g+1]})]})},g)})}),a.videoGenOriginImageUrl&&(0,e.jsxs)("div",{style:{marginTop:"16px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px",fontWeight:"bold"},children:"\u539F\u59CB\u56FE\u7247:"}),C(a.videoGenOriginImageUrl)]})]})},G=function(s){return s=="NIJI_JOURNEY"?(0,e.jsx)(I.Z,{color:"green",children:"niji\u30FBjourney"}):s=="INSIGHT_FACE"||s=="FACE_SWAP"||s=="FACE_SWAP_VIDEO"?(0,e.jsx)(I.Z,{color:"volcano",children:"InsightFace"}):s=="MID_JOURNEY"?(0,e.jsx)(I.Z,{color:"blue",children:"Midjourney"}):"-"},z=function(s){if(!(s==null||!s))return(0,e.jsx)(I.Z,{color:"green",children:l.formatMessage({id:"pages.yes"})})},$=function(){return a.action==="VIDEO"||a.action==="VIDEO_EXTEND"?(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.video"}),children:O()}):a.action==="SWAP_VIDEO_FACE"?(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.video"}),children:(0,e.jsx)(se.Z,{vertical:!0,children:W(a.imageUrl)})}):(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.image"}),children:C(a.imageUrl)})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(V.Z,{type:"inner",title:l.formatMessage({id:"pages.account.basicInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:"ID",children:a.id}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.type"}),children:a.displays.action}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.status"}),children:B(a.status)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.progress"}),children:k(a.progress)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.prompt"}),children:f(a.prompt)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.promptEn"}),children:f(a.promptEn)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.description"}),children:f(a.description)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.submitTime"}),children:a.displays.submitTime}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.startTime"}),children:a.displays.startTime}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.finishTime"}),children:a.displays.finishTime}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.failReason"}),children:f(a.failReason)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.state"}),children:f(a.state)}),$(),(a.action==="VIDEO"||a.action==="VIDEO_EXTEND")&&a.videoDuration&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.Z.Item,{label:"\u89C6\u9891\u65F6\u957F",children:[a.videoDuration,"s"]}),(0,e.jsx)(n.Z.Item,{label:"\u5E27\u6570",children:a.frameCount})]})]})}),(0,e.jsx)(V.Z,{type:"inner",title:l.formatMessage({id:"pages.task.extendedInfo"}),style:{margin:"10px"},children:(0,e.jsxs)(n.Z,{column:2,children:[(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.botType"}),children:G(a.botType)}),(0,e.jsx)(n.Z.Item,{label:"Nonce",children:a.nonce}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.account.channelId"}),children:a.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.instanceId"}),children:a.properties.discordInstanceId}),(0,e.jsx)(n.Z.Item,{label:"Hash",children:a.properties.messageHash}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.messageContent"}),children:f(a.properties.messageContent)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.finalPrompt"}),children:f(a.properties.finalPrompt)}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.finalPromptZh"}),children:f(a.promptCn||"-")}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.actionId"}),children:f(a.properties.custom_id||"-")}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.modalConfirm"}),children:z(a.properties.needModel)||"-"}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.imageSeed"}),children:a.seed||"-"}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.notifyHook"}),children:f(a.properties.notifyHook||"-")}),(0,e.jsx)(n.Z.Item,{label:l.formatMessage({id:"pages.task.ip"}),children:a.clientIp||"-"})]})})]})},ie=re,J=i(66927),ne=i(82061),le=i(90930),oe=i(99191),de=i(53025),ue=i(16568),ce=i(86738),ge=i(28036),M=i(67294),me=function(){var w=(0,M.useState)(!1),a=v()(w,2),l=a[0],Z=a[1],B=(0,M.useState)({}),k=v()(B,2),f=k[0],C=k[1],W=(0,M.useState)(""),O=v()(W,2),G=O[0],z=O[1],$=(0,M.useState)({}),h=v()($,2),s=h[0],g=h[1],T=(0,M.useState)(1e3),K=v()(T,2),he=K[0],ve=K[1],Ie=de.Z.useForm(),xe=v()(Ie,1),je=xe[0],u=(0,R.useIntl)(),Me=sessionStorage.getItem("mj-image-prefix")||"",Se=ue.ZP.useNotification(),Y=v()(Se,2),Q=Y[0],Ee=Y[1],q=(0,M.useRef)(),Ze=function(){C({}),g({}),Z(!1)},Ce=function(r,t,o,d){je.resetFields(),z(r),C(t),g(o),ve(d),Z(!0)},Te=function(){var c=j()(p()().mark(function r(t){var o,d;return p()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,(0,J._5)(t);case 3:o=m.sent,o.success?(Q.success({message:"success",description:u.formatMessage({id:"pages.task.deleteSuccess"})}),(d=q.current)===null||d===void 0||d.reload()):Q.error({message:"error",description:o.message}),m.next=10;break;case 7:m.prev=7,m.t0=m.catch(0),console.error(m.t0);case 10:return m.prev=10,m.finish(10);case 12:case"end":return m.stop()}},r,null,[[0,7,10,12]])}));return function(t){return c.apply(this,arguments)}}(),be=(0,M.useState)(!0),_=v()(be,2),H=_[0],ye=_[1],ee=function(){ye(!1)},Re=function(r){return r&&(0,e.jsx)("video",{width:"200",controls:!0,src:Me+r,placeholder:(0,e.jsx)(S.Z,{tip:"Loading",size:"large"})})},Ae=[{title:"ID",dataIndex:"id",width:160,align:"center",fixed:"left",render:function(r,t){return(0,e.jsx)("a",{onClick:function(){return Ce(u.formatMessage({id:"pages.task.info"}),(0,e.jsx)(ie,{record:t}),null,1100)},children:r})}},{title:u.formatMessage({id:"pages.task.type"}),dataIndex:"action",width:140,align:"center",request:function(){var c=j()(p()().mark(function t(){return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"Imagine",value:"IMAGINE"},{label:"Upscale",value:"UPSCALE"},{label:"Variation",value:"VARIATION"},{label:"Zoom",value:"ZOOM"},{label:"Pan",value:"PAN"},{label:"Describe",value:"DESCRIBE"},{label:"Blend",value:"BLEND"},{label:"Shorten",value:"SHORTEN"},{label:"SwapFace",value:"SWAP_FACE"},{label:"SwapVideoFace",value:"SWAP_VIDEO_FACE"},{label:"Video",value:"VIDEO"},{label:"Video Extend",value:"VIDEO_EXTEND"},{label:"Edit",value:"EDIT"},{label:"Retexture",value:"RETEXTURE"}]);case 1:case"end":return d.stop()}},t)}));function r(){return c.apply(this,arguments)}return r}(),render:function(r,t){return t.displays.action}},{title:u.formatMessage({id:"pages.task.preview"}),dataIndex:"imageUrl",width:80,align:"center",hideInSearch:!0,render:function(r,t,o){return t.action==="SWAP_VIDEO_FACE"?t.thumbnailUrl&&(0,e.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover",cursor:"pointer"},height:60,src:t.thumbnailUrl,preview:!1,onClick:function(){window.open(t.imageUrl)},loading:"lazy",onLoad:ee,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(S.Z,{spinning:H})})},o):(t.thumbnailUrl||t.imageUrl)&&(0,e.jsx)(U.Z.PreviewGroup,{items:t.images||[],children:(0,e.jsx)(U.Z,{style:{borderRadius:0,maxWidth:120,objectFit:"cover"},height:60,src:t.thumbnailUrl||t.imageUrl,preview:{src:t.imageUrl,mask:(0,e.jsx)(S.Z,{spinning:H})},loading:"lazy",onLoad:ee,placeholder:(0,e.jsx)("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(S.Z,{spinning:H})})},o)})}},{title:u.formatMessage({id:"pages.task.instanceId"}),dataIndex:"instanceId",width:180,align:"center",render:function(r,t){return t.properties.discordInstanceId}},{title:u.formatMessage({id:"pages.task.submitTime"}),dataIndex:"submitTime",width:160,hideInSearch:!0,align:"center",render:function(r,t){return t.displays.submitTime}},{title:u.formatMessage({id:"pages.task.status"}),dataIndex:"status",width:90,align:"center",request:function(){var c=j()(p()().mark(function t(){return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:u.formatMessage({id:"pages.task.NOT_START"}),value:"NOT_START"},{label:u.formatMessage({id:"pages.task.SUBMITTED"}),value:"SUBMITTED"},{label:u.formatMessage({id:"pages.task.MODAL"}),value:"MODAL"},{label:u.formatMessage({id:"pages.task.IN_PROGRESS"}),value:"IN_PROGRESS"},{label:u.formatMessage({id:"pages.task.FAILURE"}),value:"FAILURE"},{label:u.formatMessage({id:"pages.task.SUCCESS"}),value:"SUCCESS"},{label:u.formatMessage({id:"pages.task.CANCEL"}),value:"CANCEL"}]);case 1:case"end":return d.stop()}},t)}));function r(){return c.apply(this,arguments)}return r}(),render:function(r,t){var o="default";return r=="NOT_START"?o="default":r=="SUBMITTED"?o="lime":r=="MODAL"?o="warning":r=="IN_PROGRESS"?o="processing":r=="FAILURE"?o="error":r=="SUCCESS"?o="success":r=="CANCEL"&&(o="magenta"),(0,e.jsx)(I.Z,{color:o,children:t.displays.status})}},{title:u.formatMessage({id:"pages.task.mode"}),dataIndex:"mode",width:90,align:"center",request:function(){var c=j()(p()().mark(function t(){return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",[{label:"RELAX",value:"RELAX"},{label:"FAST",value:"FAST"},{label:"TURBO",value:"TURBO"}]);case 1:case"end":return d.stop()}},t)}));function r(){return c.apply(this,arguments)}return r}(),render:function(r,t){return t.mode||"FAST"}},{title:u.formatMessage({id:"pages.task.progress"}),dataIndex:"progress",width:130,showInfo:!1,hideInSearch:!0,render:function(r,t){var o=0;r&&r.indexOf("%")>0&&(o=parseInt(r.substring(0,r.indexOf("%"))));var d="normal";return t.status=="SUCCESS"?d="success":t.status=="FAILURE"&&(d="exception"),(0,e.jsx)(X.Z,{percent:o,status:d,size:"small"})}},{title:u.formatMessage({id:"pages.task.useTime"}),dataIndex:"useTime",width:80,ellipsis:!0},{title:u.formatMessage({id:"pages.task.description"}),dataIndex:"description",width:250,ellipsis:!0},{title:u.formatMessage({id:"pages.task.failReason"}),dataIndex:"failReason",width:220,ellipsis:!0},{title:u.formatMessage({id:"pages.operation"}),dataIndex:"operation",width:100,key:"operation",fixed:"right",align:"center",hideInSearch:!0,render:function(r,t){return(0,e.jsx)(ce.Z,{title:u.formatMessage({id:"pages.task.delete"}),description:u.formatMessage({id:"pages.task.deleteTitle"}),onConfirm:function(){return Te(t.id)},children:(0,e.jsx)(ge.ZP,{danger:!0,icon:(0,e.jsx)(ne.Z,{})})})}}];return(0,e.jsxs)(le._z,{children:[Ee,(0,e.jsx)(V.Z,{children:(0,e.jsx)(oe.Z,{columns:Ae,scroll:{x:1e3},search:{defaultCollapsed:!0},pagination:{pageSize:10,showQuickJumper:!1,showSizeChanger:!1},rowKey:"id",actionRef:q,request:function(){var c=j()(p()().mark(function r(t){var o,d,D;return p()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,J.Pn)(A()(A()({},t),{},{pageNumber:t.current-1}));case 2:return o=E.sent,d=o.list.map(function(b){return b.imageUrl||""}).filter(function(b){return b!=""}),D=o.list,D.forEach(function(b,Ue){b.images=d}),E.abrupt("return",{data:D,total:o.pagination.total,success:!0});case 7:case"end":return E.stop()}},r)}));return function(r){return c.apply(this,arguments)}}()})}),(0,e.jsx)(P.Z,{title:G,modalVisible:l,hideModal:Ze,modalContent:f,footer:s,modalWidth:he})]})},fe=me},27986:function(ae,y,i){var F=i(28248),A=i(85893),N=function(x){var j=x.title,L=x.modalVisible,v=x.hideModal,P=x.modalContent,R=x.footer,I=x.modalWidth;return(0,A.jsx)(F.Z,{title:j,open:L,onCancel:v,footer:R,width:I,children:P})};y.Z=N}}]);
